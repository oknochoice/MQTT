syntax = "proto3";

package chat;

option cc_enable_arenas = true;

message Error {
  uint32 errnum = 1;
  string errmsg = 2;
}

message Noti_Message {
  string messageID = 1;
}

message Noti_Unread {
  map<string, uint32> unreadNodes = 1;
}

message Device {
  enum    OperatingSystem {iOS = 0; Android = 1;}
  OperatingSystem OS = 1;
  string          OSVersion = 2;
  string          clientVersion = 3;// Dot-decimal notation
  string          appVersion = 4; // Dot-decimal notaiton
  string          deviceModel = 5;
  string          UUID = 6;
  uint32          shortID = 7;// from 1 ...
  bool            isLogin = 8;
  bool            isConnected = 9;
  bool            isReciveNoti = 10;
}

message UserInfo {
  string id = 1;
  string toNodeID = 2;
  string nickname = 3;
  uint32 unReadMessage = 4;
}

message GroupInfo {
  string id = 1;
  string toNodeID = 2;
  uint32 unReadMessage = 3;
}

message Group {
  enum      Authorize {creator = 0; manager = 1; member = 2;}
  string    id = 1;
  string    toNodeID = 2;
  Authorize authorize = 3;
  string    creatorID = 4;
  repeated  string managerIDs = 5;
  repeated  UserInfo members = 6;
}

message User {
  string    id = 1;
  string    realname = 2;
  string    nickname = 3;
  bytes     icon= 4;
  string    description = 5;
  bool      isMale = 6;
  string    phoneNo = 7;
  string    countryCode = 8;// default is 86
  string    password = 9; // sha1 double
  uint32    birthday = 10;
  repeated  UserInfo friends = 11;
  repeated  string blacklist = 12;
  repeated  GroupInfo groups = 13;
  repeated  Device devices = 14;
}

message Register {

  string phoneNo = 1;
  string countryCode = 2;// default is 86
  string password = 3; // sha1 double
  string nickname = 4;

}

message Login {

  string phoneNo = 1;
  string countryCode = 2;// default is 86
  string password = 3; // sha1 double
  Device device = 4;

}

message Logout {

  string phoneNo = 1;
  string countryCode = 2;// default is 86
  Device device = 3;

}

message ChatMessage {
  
  enum   Type { TEXT = 0; JPG = 1; MP3 = 2;}
  string fromUserID = 1;
  string toNodeID = 2;
  uint32 repeatedNo = 3;
  uint32 totalCount = 4;
  uint32 deviceShortID = 5;
  uint32 timestampClient = 6;
  uint32 timestampServer = 7;
  Type   type = 8;
  bytes  content = 9;
  
}

message Connect {
  string userID = 1;
  string UUID = 2;
  bool   isLogin = 3;
  bool   isConnected = 4;
  bool   isReciveNoti = 5;
}

message DisConnect {
  string userID = 1;
  string UUID = 2;
}

// in memory mongodb 
// user login connect pushMessage info.
// index chatMessageNode userID 1, UUID 1

message ConnectInfo {
  string nodeID = 1;
  string userID = 2;
  string UUID = 3;
  bool   isLogin = 4;
  bool   isConnected = 5;
  bool   isReciveNoti = 6;
  string serverName = 7;
  uint64 nodepointor = 8;
}




